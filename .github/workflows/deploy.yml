name: Autodoc and Build
on:
  push:
    branches:
      - development
    tags:
      - "v*"
permissions:
  contents: write
jobs:
  build:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v3

      - name: Set up Go
        uses: actions/setup-go@v3
        with:
          go-version: 1.20.1

      - name: Install GoDoc
        run: |
          go get golang.org/x/tools/cmd/godoc 
          go install golang.org/x/tools/cmd/godoc
          go install gitlab.com/tslocum/godoc-static@latest
          rm docs -rf
          mkdir docs
          godoc-static -destination=./docs .

      - name: Deploy Doc üöÄ
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: docs # The folder the action should deploy.

      - name: Build
        run: GOOS=windows go build main.go

      - name: "Release"
        uses: "marvinpinto/action-automatic-releases@latest"
        with:
          title: "Release"
          repo_token: "${{ secrets.TOKEN }}"
          prerelease: false
          files: |
            *.exe
